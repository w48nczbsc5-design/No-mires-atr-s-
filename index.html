<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
<title>NO DEBISTE ABRIR ESTO</title>

<style>
html,body{
  margin:0;
  padding:0;
  background:black;
  color:#ddd;
  font-family:monospace;
  height:100%;
  overflow:hidden;
}

#start{
  position:fixed;
  inset:0;
  display:flex;
  justify-content:center;
  align-items:center;
  font-size:22px;
  z-index:10;
}

#game{
  padding:20px;
  font-size:18px;
}

.choice{
  margin-top:20px;
  padding:14px;
  border:1px solid #222;
  text-align:center;
}

#entity{
  position:fixed;
  inset:0;
  background:url('data:image/svg+xml;utf8,\
<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 200 200">\
<rect width="200" height="200" fill="black"/>\
<ellipse cx="70" cy="80" rx="18" ry="25" fill="white"/>\
<ellipse cx="130" cy="85" rx="10" ry="30" fill="white"/>\
<circle cx="70" cy="80" r="6" fill="black"/>\
<circle cx="130" cy="85" r="4" fill="black"/>\
<path d="M50 140 Q100 120 150 150" stroke="white" fill="none"/>\
</svg>');
  background-size:cover;
  opacity:0;
  filter:contrast(200%) blur(1px);
  z-index:9;
}

#glitch{
  position:fixed;
  inset:0;
  background:white;
  opacity:0;
  z-index:8;
}
</style>
</head>

<body>

<div id="start">Toca para continuar</div>
<div id="game"></div>
<div id="entity"></div>
<div id="glitch"></div>

<audio id="amb" loop>
<source src="https://cdn.pixabay.com/audio/2022/08/02/audio_1c1fa5d3b3.mp3">
</audio>

<audio id="hit">
<source src="https://cdn.pixabay.com/audio/2022/03/15/audio_7fddc5a2f4.mp3">
</audio>

<script>
const game = document.getElementById("game");
const start = document.getElementById("start");
const entity = document.getElementById("entity");
const glitch = document.getElementById("glitch");
const amb = document.getElementById("amb");
const hit = document.getElementById("hit");

function type(t,cb){
  game.innerHTML="";
  let i=0;
  let s=setInterval(()=>{
    game.innerHTML+=t[i++];
    if(i>=t.length){clearInterval(s);cb&&cb();}
  },35);
}

function flash(){
  glitch.style.opacity=0.6;
  setTimeout(()=>glitch.style.opacity=0,80);
}

function showEntity(){
  entity.style.opacity=0.25;
  setTimeout(()=>entity.style.opacity=0,200);
}

function vibr(ms){
  navigator.vibrate && navigator.vibrate(ms);
}

function scene1(){
  type(`Hay alguien contigo.
No debería tener esa forma.`,()=>{
    choice("Seguir leyendo",scene2);
  });
}

function scene2(){
  flash();
  showEntity();
  vibr(200);
  type(`No tiene ojos correctos.
Pero te está mirando.`,()=>{
    choice("No mires",finalScene);
  });
}

function finalScene(){
  amb.pause();
  hit.play();
  vibr([100,50,200,50,300]);
  entity.style.opacity=1;
  game.innerHTML="TE VIO";
}

function choice(txt,fn){
  let d=document.createElement("div");
  d.className="choice";
  d.textContent=txt;
  d.onclick=fn;
  game.appendChild(d);
}

start.onclick=()=>{
  start.style.display="none";
  amb.volume=0.5;
  amb.play();
  scene1();
};
</script>

</body>
</html>
